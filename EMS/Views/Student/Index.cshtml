@model EMS.Models.ApplicationUser

@{
    ViewData["Title"] = "Student Dashboard";
    var notices = ViewBag.Notices as List<EMS.Models.Notice>;

    // গ্রিটিংস লজিক
    var currentHour = DateTime.Now.Hour;
    string greeting;
    if (currentHour >= 5 && currentHour < 12) { greeting = "Good Morning"; }
    else if (currentHour >= 12 && currentHour < 17) { greeting = "Good Afternoon"; }
    else { greeting = "Good Evening"; }
}

<div class="mb-4 pb-2 border-bottom d-flex justify-content-between align-items-center">
    <div>
        <h4 class="text-dark fw-bold mb-1">@greeting, @Model.FirstName! 🎓</h4>
        <p class="text-muted mb-0 small">Here's your academic overview.</p>
    </div>
    <div class="text-end">
        <h6 class="mb-0 fw-bold text-primary">@DateTime.Now.ToString("dddd")</h6>
        <small class="text-muted">@DateTime.Now.ToString("dd MMM yyyy")</small>
    </div>
</div>

<div class="row g-4 mb-5">
    <div class="col-lg-8">

        <div class="card shadow-sm border-0 mb-4 bg-primary bg-opacity-10">
            <div class="card-body p-4">
                <div class="d-flex align-items-center">
                    <div class="bg-white text-primary rounded-circle d-flex justify-content-center align-items-center me-4 shadow-sm" style="width: 80px; height: 80px;">
                        <i class="fa-solid fa-user-graduate fa-3x"></i>
                    </div>
                    <div>
                        <h4 class="fw-bold text-primary mb-1">@Model.FirstName @Model.LastName</h4>
                        <div class="d-flex gap-2 mb-2">
                            <span class="badge bg-white text-primary border shadow-sm">ID: @Model.StudentProfile?.StudentRoll</span>
                            <span class="badge bg-white text-info border shadow-sm">@Model.StudentProfile?.Department?.Name</span>
                        </div>
                        <div class="text-muted small">
                            <i class="fa-solid fa-calendar-days me-1"></i> Session: @Model.StudentProfile?.Session |
                            <span class="fw-bold text-dark">@Model.StudentProfile?.Semester?.Name</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row g-3">
            <div class="col-md-6">
                <div class="card shadow-sm border-0 h-100">
                    <div class="card-body d-flex align-items-center">
                        <div class="bg-warning bg-opacity-10 p-3 rounded me-3 text-warning">
                            <i class="fa-solid fa-list-check fa-2x"></i>
                        </div>
                        <div>
                            <h6 class="text-muted text-uppercase small fw-bold mb-1">Assignments</h6>
                            <a asp-action="Assignments" class="text-decoration-none fw-bold text-dark stretched-link">View Tasks &rarr;</a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="card shadow-sm border-0 h-100">
                    <div class="card-body d-flex align-items-center">
                        <div class="bg-success bg-opacity-10 p-3 rounded me-3 text-success">
                            <i class="fa-solid fa-square-poll-vertical fa-2x"></i>
                        </div>
                        <div>
                            <h6 class="text-muted text-uppercase small fw-bold mb-1">Results</h6>
                            <a asp-action="MyResults" class="text-decoration-none fw-bold text-dark stretched-link">Check Marks &rarr;</a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="card shadow-sm border-0 h-100">
                    <div class="card-body d-flex align-items-center">
                        <div class="bg-info bg-opacity-10 p-3 rounded me-3 text-info">
                            <i class="fa-solid fa-book-open fa-2x"></i>
                        </div>
                        <div>
                            <h6 class="text-muted text-uppercase small fw-bold mb-1">My Courses</h6>
                            <a asp-action="MyCourses" class="text-decoration-none fw-bold text-dark stretched-link">Course List &rarr;</a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="card shadow-sm border-0 h-100">
                    <div class="card-body d-flex align-items-center">
                        <div class="bg-danger bg-opacity-10 p-3 rounded me-3 text-danger">
                            <i class="fa-solid fa-chart-pie fa-2x"></i>
                        </div>
                        <div>
                            <h6 class="text-muted text-uppercase small fw-bold mb-1">Attendance</h6>
                            <a asp-action="MyAttendance" class="text-decoration-none fw-bold text-dark stretched-link">View Report &rarr;</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <div class="col-lg-4">
        <div class="card shadow-sm border h-100">
            <div class="card-header bg-light py-3 border-bottom d-flex justify-content-between align-items-center">
                <h6 class="mb-0 fw-bold text-dark"><i class="fa-solid fa-bullhorn text-warning me-2"></i> Recent Notices</h6>
                <a asp-action="Notices" class="btn btn-sm btn-white border bg-white text-muted shadow-sm"><i class="fa-solid fa-arrow-right"></i></a>
            </div>
            <div class="card-body p-0">
                @if (notices != null && notices.Any())
                {
                    <div class="list-group list-group-flush">
                        @foreach (var notice in notices)
                        {
                            <a asp-action="NoticeDetails" asp-route-id="@notice.Id" class="list-group-item list-group-item-action border-0 px-4 py-3 border-bottom">
                                <div class="d-flex w-100 justify-content-between align-items-center mb-1">
                                    <small class="text-muted" style="font-size: 0.75rem;"><i class="fa-regular fa-clock me-1"></i> @notice.PostedDate.ToString("dd MMM")</small>
                                </div>
                                <h6 class="mb-0 text-dark fw-bold text-truncate" style="font-size: 0.9rem;">@notice.Title</h6>
                            </a>
                        }
                    </div>
                }
                else
                {
                    <div class="p-5 text-center text-muted">
                        <i class="fa-regular fa-folder-open fa-2x mb-3 opacity-25"></i>
                        <p class="mb-0 small">No new notices published.</p>
                    </div>
                }
            </div>
        </div>
    </div>
</div>